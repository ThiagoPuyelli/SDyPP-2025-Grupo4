Modifique el código de B para que si el proceso A cierra la conexión (por ejemplo matando el proceso) siga funcionando.